import tkinter as tk
from tkinter import messagebox, filedialog
from PIL import Image, ImageTk


def calculate_payments():
    try:
        car_price = float(entry_price.get())
        deposit = float(entry_deposit.get())
        interest_rate = float(entry_interest.get()) / 100 
        years = int(entry_years.get())

        loan_amount = car_price - deposit
        monthly_rate = interest_rate / 12 if interest_rate > 0 else 0
        months = years * 12

        if loan_amount <= 0:
            messagebox.showerror("Error", "Deposit must be less than the car price.")
            return

        if monthly_rate > 0:
            monthly_payment = (loan_amount * monthly_rate * (1 + monthly_rate) ** months) / \
                              ((1 + monthly_rate) ** months - 1)
        else:
            monthly_payment = loan_amount / months 

        show_result_window(monthly_payment)

        create_csv(car_price, deposit, interest_rate, years, monthly_payment)

    except ValueError:
        messagebox.showerror("Error", "Please enter valid numeric values.")


def show_result_window(monthly_payment):
    result_window = tk.Toplevel(root)  
    result_window.title("Loan Payment Result")
    result_window.geometry("400x300")

    label_result = tk.Label(result_window, text=f"Monthly Payment: ${monthly_payment:.2f}", font=("Arial", 14, "bold"), fg="blue")
    label_result.pack(pady=20)

    try:
        img2 = Image.open(r"C:\Users\jeffe\OneDrive\Desktop\Codes\Dodge Challenger.jpg") 
        img2 = img2.resize((400, 300))  
        photo2 = ImageTk.PhotoImage(img2)
        label_image2 = tk.Label(result_window, image=photo2)
        label_image2.image = photo2  
        label_image2.pack(pady=10)
    except FileNotFoundError:
        label_error2 = tk.Label(result_window, text="Image not found!", fg="red", font=("Arial", 12, "bold"))



def create_csv(price, deposit, rate, years, payment):
    months = years * 12
    balance = price - deposit
    monthly_rate = rate / 12



    messagebox.showinfo("Good luck with the new car.", "Try with a new plan ")
    

# GUI setup (main window)
root = tk.Tk()
root.title("Car Loan Calculator")
root.geometry("600x600")

# Input Fields
tk.Label(root, text="Car Price ($):", font=("Arial", 12),bg="green", fg="white").grid(row=0, column=0, padx=10, pady=5)
entry_price = tk.Entry(root)
entry_price.grid(row=0, column=1, padx=10, pady=5)

tk.Label(root, text="Deposit ($):", font=("Arial", 12),bg="green", fg="#f0f0f0").grid(row=1, column=0, padx=10, pady=5)
entry_deposit = tk.Entry(root)
entry_deposit.grid(row=1, column=1, padx=10, pady=5)

tk.Label(root, text="Interest Rate (%):", font=("Arial", 12),bg="yellow", fg="black").grid(row=2, column=0, padx=10, pady=5)
entry_interest = tk.Entry(root)
entry_interest.grid(row=2, column=1, padx=10, pady=5)

tk.Label(root, text="Loan Duration (Years):", font=("Arial", 12), bg="cyan", fg="black").grid(row=3, column=0, padx=10, pady=5)
entry_years = tk.Entry(root)
entry_years.grid(row=3, column=1, padx=10, pady=5)


btn_calculate = tk.Button(root, text="Calculate", font=("Arial", 12, "bold"), command=calculate_payments)
btn_calculate.grid(row=4, column=0, columnspan=2, pady=10)

# Exit Button
btn_exit = tk.Button(root, text="Exit", font=("Arial", 12, "bold"), command=root.quit, bg="red", fg="white")
btn_exit.grid(row=0, column=2, columnspan=2, pady=10)

#Display first image
try:
    img1 = Image.open(r"C:\Users\jeffe\OneDrive\Desktop\Codes\Dodge Charger.jpg")  
    img1 = img1.resize((500, 500)) 
    photo1 = ImageTk.PhotoImage(img1)
    label_image1 = tk.Label(root, image=photo1)
    label_image1.image = photo1 
    label_image1.grid(row=5, column=0, columnspan=2, pady=10)
except FileNotFoundError:
    label_error1 = tk.Label(root, text="Image 1 not found!", fg="red", font=("Arial", 12, "bold"))
    label_error1.grid(row=5, column=0, columnspan=2, pady=10)

root.mainloop()
